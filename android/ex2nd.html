<!DOCTYPE html>
<html lang="ja">
    <head>
        <title>ITX1:Aoyama Gakuin University</title>
        <link rel="stylesheet" type="text/css" href="assets/css/itx1.css">
        <link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/vs.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
        <link href="assets/plugins/highlight/styles/default.css" rel="stylesheet">
        <script href="assets/plugins/highlight/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    </head>
    <body>
        <div class="container">
            <div class="title">
                <h1>第2回： Android GUI</h1>
            </div>
            <p style="text-align: right;">
              最終更新日：2024年3月16日
            </p>
          <p><a href="index.html">ホームへ戻る</a></p>

            <div class="contents">
              <h2>Androidにおける GUI ( Graphical User Interface) の仕組み</h2>

            <div class="practice practice-checkpoint">
              <h3>本日の授業中に実行確認する内容（TA・教員のチェック有）</h3>
              <p><strong>各演習課題を実施・確認・提出して下さい。実行確認は、TA・教員からのチェックを受けて下さい。</strong></p>
              <p><strong>
          【チェック合格条件】</strong>各スクリーンショットと内容が一致すること（色は問わない）</p>
              <ul>
                  <li><strong>演習問題2_1：「h」の操作ができていること（必須）</strong></li>
                  <li><strong>演習問題2_2：a～hの実行（必須）</strong></li>
                  <li><strong>演習問題2_3：a～bの実行（必須）</strong></li>
                  <li>[任意] 演習問題2_4：a～dの実行</li>
              </ul>
              <h3>本日のレポート内容</h3>
              <p>CANVASのAssignmentsの指示に従うこと。</p>
          </div>
				
              <h3>ACTIVITYの役割（一般的な説明）</h3>              
              <p>
                ActivityはAndroidアプリの基本的なコンポネントである。Activityの役割はUser Interfaceを提示することとともに、システムやユーザの入力に反応することである。<br />
                ユーザインタフェイスを用いるアプリは<strong>少なくとも１つのActivity</strong>もしくは複数のActivitiesで構成される。
                存在しているActivityは他の新しいActivityに入れ替えられることが可能である。<br />なお新しいActivityは同じ制約（Manifest.xmlに記載されているIntent）を守らなければならない。
                Android Projectに新しいActivityを追加する手順は下記の通りになる。
              </p>
              <ul>
                <li>
                新しいJava Classを作成し、<strong>Activity</strong> (もしくは<strong>AppCompatAcitivity</strong>) <strong>Classを継承</strong> (extends予約語) させる。
                <br>例えばアプリの関連情報をユーザに入力させるための設定画面が用意したい。</li>
                <li>
                  作成した“Settings” ActivityアプリのManifest.xmlに定義しておく。
                </li>
              </ul>
              <pre>
                <code class="xml">
        &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
        &lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; package=&quot;jp.aoyama.a5822000.sample1_1&quot; &gt;
          &lt;application&gt;
            android:allowBackup="true"
            android:icon="@mipmap/ic_launcher"
            android:label="@string/app_name"
            android:theme="@style/AppTheme" >
            //既存のActivity
            &lt;activity
              android:name=".Sample1_1" android:label="@string/app_name" >
              &lt;intent-filter>
                  //アプリ起動時、最初に起動可能と設定したいActivity
                  &lt;action android:name="android.intent.action.MAIN" />
                  &lt;category android:name="android.intent.category.LAUNCHER" />
              &lt;/intent-filter>
            &lt;/activity>
            //以下新しく追加したActivity
            &lt;activity
              android:name=".Settings" android:label="@string/settings" >
                  &lt;intent-filter>
                    &lt;action android:name="android.intent.action.MAIN" />
                  &lt;/intent-filter>
            &lt;/activity>
          &lt;/application>
        &lt;/manifest>
                </code>
              </pre>
            </div>

            <div class="contents">
              <h3>ACTIVITYによるGUI表示の仕組み</h3>
              <p>今回の目標はAndroidアプリのGUI開発の基礎を把握することです。本資料を注意深く読めば、各演習課題は十分実施できる内容です。UI開発に関するより詳細な説明は、Android Developersサイトの<a href="https://developer.android.com/studio/write/layout-editor"><strong>「Develop a UI with Views」を参照</strong></a>することをお勧めします（それでも分からない場合はネット・○○GPTで検索してみましょう）。
              </p>
              <p>
                各<strong>Activity</strong>に対して、テキストなどのUI要素が描けるように、<u>デフォルトのウィンドウ</u>が与えられている。<br />
                基本的にウィンドウは画面全体を埋めるが、画面より小さくしたり、他のウィンドウの上にポップアップのように浮かせたりすることが可能。<br />
                Activityの<u>視覚的な内容</u>は<strong>View</strong>というObject類の階層組織が提供と制御を行なっている。
                <ul>
                  <li>殆どのActivityは情報・画像提示もしくはユーザに情報入力させるためのView階層を提示している。</li>
                  <li>基礎的なView Classに起源をもつObjects（自分のオリジナルなViewが作れる）</li>
                  <li>予め用意されている基本的なViewがある：Layout、TextView、Button、CheckBox、ImageView．．．</li>
                  <li><strong>Activity.setContentView(...)</strong> methodを用いてユーザが定義したView階層をActivityウィンドウ内に置く。</li>
                  <li>各Activityは複数Viewを作成することができる。</li>
                  <li>各Viewは図画オブジェクトで構成され、その図画が全面、もしくは画面の一部を埋める。</li>
                  <li>View階層に含まれている<strong>すべてのオブジェクトをXMLで定義・記述</strong>することができる。なお、一部の高度な属性はXMLで設定できないこともある。</li>
                </ul>
              </p>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig1.png" class="figure-img img-fluid rounded" alt="fig1.png">
                  <figcaption class="figure-caption text-center">図１ View階層の構成イメージ</figcaption>
              </figure><br />
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig2.png" class="figure-img img-fluid rounded" alt="fig2.png">
                  <figcaption class="figure-caption text-center">図２ AndroidアプリのGUI（Graphical User Interface）開発のため予め用意されているViewの一例</figcaption>
              </figure>
            </div>

            <div class="contents">
              <h2>Android におけるGUI開発、デザイン編集機能と、コード編集機能</h2>
              <h3>（第２回の演習課題説明はここから！）</h3>
              <p>
              <strong>Androidの開発において、プログラミング（実現したい機能、動作など）は<u>Javaファイル</u>として作成、レイアウトのデザイン（実装したい見た目、画面構成など）は<u>XMLファイル</u>として作成する。</strong></p>
              
            <h4>第２回～利用する新しいプロジェクトの作成</h4>

              <p>
                下記の属性を持った新しいAndroid Projectを作成する。ただし、<strong><u>自分の名前の頭文字</u>・<u>自分の学生番号</u></strong>を使用すること（LGのままにしないこと！LGとはLopez Guillaumeの頭文字．．．）。
              </p>
              <pre>
                <code class="java">
      Activity: Empty Views Activity
      Name: <strong>LG</strong> First Android GUI
      Package name: jp.aoyama.<strong>a5822000</strong>.<strong>lg</strong>firstandroidgui
      Save location: 任意
      Language: Java
                </code>
              </pre>
              <h4>ソースコードEDITOR機能の使い方</h4>
              <div class="practice">
                <h3>演習問題2_1: </h3>
                ａ～ｉの手順を参考に（他のやり方もあります）、<strong>「ｉ」に書いてある操作ができる</strong>ようなアプリＧＵＩを作りましょう。<br>
                まず、ａ～ｃを参考に、実行時図５と同じ（色は異なっても良い）になるように必要な修正をしましょう。
                <ol type="a">
                  <li>activity_main.xmlのTextViewオブジェクトの文字を修正する（内容は<strong><u>自分の名前の頭文字</u>・<u>自分の学生番号</u></strong>にすること！）</li>
                  <li>また、その文字列が画面の右下に常に表示されるように調整する。</li>
                  <li>必要に応じてresources（style.xml、strings.xmlなど）も修正する。</li>
                </ol>
              </div>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig3.png" class="figure-img img-fluid rounded" alt="fig3.png">
                  <figcaption class="figure-caption text-center">図３　Javaプログラム（MainActivity.java）とXMLレイアウト（activity_main.xml）の関係</figcaption>
              </figure><br />
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig5.png" class="figure-img img-fluid rounded" alt="fig5.png" border="4px">
                  <figcaption class="figure-caption text-center">図４　タイトルバーが表示されない場合、Show System UIにチェックを入れる</figcaption>
              </figure>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig4.png" class="figure-img img-fluid rounded" alt="fig4.png" border="4px">
                  <figcaption class="figure-caption text-center">図５　演習問題2_1(c)の実施結果スクリーンショット例</figcaption>
              </figure>
              <p></p>
              <h4>XML形式で作成したリソース（Layout、Strings等々）をJavaのコードで扱う方法</h4>
              <p>
                XMLで定義した各<strong>Viewオブジェクトに対応したID</strong>を設定することができる。そのため、XMLファイル内のViewの開始～終了タグ間下記のようなコードを追加する。例えば、「res/layout」にある"<strong>activity_main.xml</strong>"にある"TextView"オブジェクトの場合、以下のように、<code>android:id="@+id/author"</code>を追加することがで、IDが付与されます。UIのDesignモードでそのオブジェクトを選択したうえで、Attributes（属性）リストの一番上にある「id」に直接入力することも可能です。<br><br>
                  <pre><code>
  &lt;TextView
    &emsp;android:id="@+id/author"
    &emsp;android:layout_width="wrap_content"
    &emsp;android:layout_height="wrap_content"
    &emsp;android:text="©LG23428"
    &emsp;...
  /&gt;                      
                </code></pre><br />
                上記のように設定したIDを用いて、XMLで定義した各Viewオブジェクト（TextView、Button、Layout等は全て"View型"です）をJavaのコードから参照して、そのオブジェクトに対応したClassのInstanceを生成することができる。<br />
                そのため、<strong>Javaファイル内</strong>（Instanceを生成・利用したいメソッドの範囲内）下記のように<strong>findViewById</strong>メソッドを用いる。<br /><br>
                <pre><code>TextView appliAuthor = (TextView)findViewById(R.id.author);</code></pre><br /><br>
                このように、生成されたInstanceに対して通常のオブジェクトのように、各methodを呼び出すことができます。<strong>(Rは全てのXML resources（layout、strings、values…）から自動生成 されたJava Class)</strong>。例えば、<strong>appliAuthor</strong>変数は<strong>TextView Class</strong>オブジェクトのInstanceとなり、javaのコードにて様々な操作ができるようになります。例えば、アプリ操作の途中、右下の署名を消したいとすると、以下のようなコードで処理できます。<br>
                <br>
                <pre><code>appliAuthor.setText("");</code></pre>              
              </p>
      
              <div class="practice">
                <h3>演習問題2_1（続き）: </h3>
                <p>
                d~fの説明を参考にして（他の方法有り）、図８と同じくなるように必要なところを書きかえる。</p>
                <ol type="a">
                  <li value="4"> アプリのレイアウトファイル、<strong> activity_main.xml</strong>　に１つ目の<strong>Buttonを追加</strong>する。XMLコードを直接書くより、UIのDesignモードにて、「Palette」から、「Button」<strong>要素をdrag &amp; drop</strong>する方をお勧する。ボタンに<strong>"btn1"というID</strong>を付与し、幅がウィンドウの幅に、高さがボタンの内容（後で設定する文字や画像）に<strong>自動的に合わさるように設定</strong>する（"Constraint"の設定も忘れないように注意）。<strong>layout_width</strong>/<strong>layout_height</strong>属性の値は数字ではなく、<strong>wrap_content</strong>/<strong>match_parent</strong>という値を上手に使いましょう。</li>
                  <li>Buttonに<strong>表示したい文字列</strong>（例：LG First Button）を<strong>strings.xml</strong>で定義し、ボタンの「text」属性がstrings.xmlで定義した文字列と紐づける（Designモードを使えば簡単）。</li>
                  <li>２つ目のボタンを追加し、<strong>"btn2"というID</strong>を付与し、幅がボタンの内容（後で設定する文字や画像）に、高さがウィンドウの高さに<strong>自動的に合わさるように設定</strong>する（"Constraint"の設定も忘れないように注意）。</li>
                </ol>
              </div>
              <p>
                XMLレイアウト編集ウィンドウ右上にあるタブを用いて "Code"（図６）と"Design"（図７）で直接XMLタグコーディング（"code"）で行なうか、レイアウトの設計を drag &amp; drop などでグラフィカル（"design"）で行なうかは切り替えができる。基本的に design モードを利用した方が便利で速い。
              </p>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig8.png" class="figure-img img-fluid rounded" alt="fig8.png">
                  <figcaption class="figure-caption text-center">図６　"Code"によるデザイン編集</figcaption>
              </figure><br />
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig9.png" class="figure-img img-fluid rounded" alt="fig9.png">
                  <figcaption class="figure-caption text-center">図７　"Design"によるグラフィカルなデザイン編集</figcaption>
              </figure>
      
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig6.png" class="figure-img img-fluid rounded" alt="fig6.png" border="4px">
                  <figcaption class="figure-caption text-center">図８　演習2_1（f）のアプリ実行時のスクリーンショット</figcaption>
              </figure>
              <h4>Viewオブジェクトをタップした際のイベントを発生させる方法</h4>
              <p>
                Button をクリックした際のアクションも下記のようにXML内に事前定義することができる。定義したクリック時イベント名が Java プログラムコード内の method 名と紐づけられる。
                クリックアクション用のメソッドの引数として、View オブジェクトを設定することで複数の View（例：複数のボタン）が同じクリック時アクション method を用いる際。
                その method の処理コード内に、例えばどの Button がクリックされたかによって、処理を変えることができる。
              </p>
              <table class="table">
                <tr>
                  <th>XMLレイアウト（activity_main.xml内）</th>
                  <th>Javaプログラムコード（MainActivity.java内）</th>
                </tr>
                <tr>
                  <td><pre><code>
  &lt;Button
    android:id="@+id/btn1"
    android:onClick="myBtnClick"
    android:text="@string/btn1_str"
    ...
    /&gt;
                  </code></pre></td>
                  <td><pre><code>                    
    public void myBtnClick(View v){
      if (v.getId()==R.id.btn1){
        //ボタン１を栗生した場合の処理
      }
      else if (v.getId()==R.id.btn2){
        //ボタン２を栗生した場合の処理
      }
    }
                  </code></pre></td>
                </tr>
              </table>
              <div class="practice">
                <h3>演習問題2_1（終わり）:</h3>
                 ｇ～ｉの説明を参考にして（他の方法有り）、図９と同じくなるように必要なところを書き加える。
                <ol type="a">
                  <li value="7"><strong>新しい TextView</strong> オブジェクトをGUIに追加する。図 7に示すように、<strong>ボタン１の下とボタン２の右</strong>に表示されるように Constraint を設定する。なお、文字列はボタン操作に合わせて変えるため、その初期値は空のままにする。そのTextView の ID を "<strong>btn_tv_id</strong>" にする。</li>
                  <li value="8">上記に説明されている、「Viewオブジェクトをタップした際のイベントを発生させる方法」を参考に、各ボタンにタップした際の処理を行う "<strong>myBtnClick</strong>" という method を作成し、ボタンと紐づける。</li>
                  <li value="9"><strong>押したボタンに合わせて</strong>、btn_tv_id <strong>TextView で表示する文字列を変える処理</strong>を追加する。ボタン１を押した際「I Pressed ○○ First Button」、ボタン２を押した際「I Pressed ○○ Second Button」というテキストを表示させる（"○○"を自分の名前の頭文字にすること）（上の方に説明した findViewById() および、setText() methods を上手く利用して下さい）。 </li>
                </ol>
              </div>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig7.png" class="figure-img img-fluid rounded" alt="fig7.png" border="4px">
                  <figcaption class="figure-caption text-center">図９　演習問題2_1：ｉを実行し、“LG Second Button”ボタンを押した際のスクリーンショット</figcaption>
              </figure>
              
            </div>
  <p></p><p></p>
          <div class="contents">
              <h3>レイアウト（LAYOUT）でviewの配置を整える</h3>
            <p>
            Androidアプリ開発では、アプリの画面を簡単に作成できるレイアウトが数多く用意されている。<strong>レイアウトを上手く活用すること</strong>で、テキスト、ボタン、イメージなどの各 View 要素の配置がシンプルとなるだけではなく、端末の Portrait/Landscape 切り替えや、様々な端末のサイズに合わせて自動的に調整される。 </p>
            <p>GUI（activity_main.xml）のデフォールトレイアウトは ConstraintLayout ですが、<strong>本実験（演習2_2～7）では、LinearLayout （リニアレイアウト）を上手に活用すれば、GUIの要素の配置が素早くできる</strong>ため、その仕組みを理解することが大事（以下簡易紹介されている）。
            </p>
            <figure class="figure" >
                <img src="assets/images/ex2nd/fig10.png" class="figure-img img-fluid rounded" alt="fig10.png">
              <figcaption class="figure-caption text-center">図１０　View階層と各Viewに対応したLayoutの可視化の一例（©Android Developerウェブサイト）</figcaption>
              </figure>
              <p>
                主なレイアウトを紹介する。画像も見ながらイメージをつかむこと。各レイアウトの詳細な使い方は<a class="external-link" href="https://developer.android.com/guide/topics/ui/declaring-layout?hl=ja">Android Developerウェブサイト</a>、Tutorialウェブサイトや、市販の教科書を参照。<br />
                （続く各レイアウトのサンプル画像はTECHACADEMY MAGAZINEの<a class="external-link" href="https://techacademy.jp/magazine/4457">“覚えておくと便利！ANDROIDアプリ開発のLAYOUTの使い方”</a>から引用）
              </p>
			  <h4>RelativeLayout</h4>
              <p>
                他のパーツなどと相対的な関係で位置を配置したい場合に使用する。「パーツＢはパーツＡの下に配置する」という指定の仕方ができる。この場合、パーツＡを動かすと一緒にパーツＢも移動する。
              </p>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig11.png" class="figure-img img-fluid rounded" alt="fig11.png">
                  <figcaption class="figure-caption text-center">図１１　RelativeLayoutの一例：vertical（左）とhorizontal（右）</figcaption>
              </figure>

              <h4>ConstraintLayout</h4>
              <p>
			    <strong> ConstraintLayout</strong> を使用すると、フラットなビュー階層を持つ大きくて複雑なレイアウトを作成できる（ビューグループのネストはない）。すべてのビューが兄弟ビューや親のレイアウトとの関係に従って配置される点で、これは <strong>RelativeLayout と似ているが、RelativeLayout よりも柔軟性があり</strong>、Android Studio の Layout Editor で使用しやすくなっている。</p>
				<p>
			    <strong> ConstraintLayout</strong> 内でビューの位置を定義するには、<strong>ビューに対して最低 1 つの水平方向の制約と 1 つの垂直方向の制約を設定する必要</strong>がある。各制約は、別のビュー、親のレイアウト、非表示のガイドラインとの接続や位置揃えを表す。各制約により垂直軸または水平軸に沿ったビューの位置を定義する。各ビューには軸ごとに少なくとも 1 つの制約が必要ですが、それより多く必要になることもよくある。</p>
				<p> Layout Editor にビューをドロップすると、制約を設定していなくても、ビューはドロップした場所に配置される。ただし、これは編集を簡単にするだけの機能です。デバイスでレイアウトを表示すると、<strong>制約が設定されていないビューは、[0,0]（左上の隅）の位置に描画される</strong>。 </p>
			  <p>Viewの制約を設定するには、</p>
				<ol>
				  <li>4つの角にサイズ変更ハンドル(正方形)が表示されます。また、4つの側面に制約アンカー(円)が表示されます。</li>
				  <li>上部のアンカーをクリックし、レイアウトの上部にスナップするまでドラッグして放します。制約が適用され、ビューをレイアウトの上部から8dp離れた位置に配置するように指定されます。(8dpはデフォルトの設定です。)</li>
				  <li>同様にビューの左側からレイアウトの左側に対して制約を適用します。</li>
              </ol>
<p>
	  図 12 のレイアウトは、エディタ内では正常に見えますが、ビュー C には垂直方向の制約がありません。このレイアウトをデバイス上で描画すると、ビュー C の水平方向は、ビュー A の左右の外辺と同じ位置になるが、垂直方向の制約がないため、画面の一番上に表示される。
	  </p>
				<figure class="figure">
					<img src="assets/images/ex2nd/constraint-fail_2x.png"  class="figure-img img-fluid rounded" alt="図 1.エディタ内でビュー C はビュー A の下に表示されるが、垂直方向は制約がない">
				  <figcaption class="figure-caption text-center">図 １２.エディタ内でビュー C はビュー A の下に表示されるが、垂直方向は制約がない</figcaption>
			  </figure>
			  <figure class="figure">
					<img src="assets/images/ex2nd/constraint-fail-fixed_2x.png" alt="図 2. ビュー C がビュー A の下になるように垂直方向の制約を設定">
						<figcaption class="figure-caption text-center">図 １３. ビュー C がビュー A の下になるように垂直方向の制約を設定</figcaption>
					</tr>
				</figure>
				<p>詳しくはAndroid Developers Guideの「<a href="https://developer.android.com/training/constraint-layout/index.html">ConstraintLayout でレスポンシブ UI を作成する</a>」を参照すること。</p>


              <h4>LinearLayout</h4>
              <p>
                LinearLayoutとは、パーツを縦一列（vertical）もしくは横一列（horizontal）に並べる場合に使用するレイアウト。View の要素（テキスト、ボタン等）を１列に並べたいとき一番便利。「<strong>orientation</strong>」属性を「vertical」と「horizontal」に切り替えることで、並べ方を縦と横に切り替えることができる。<br>
また、レイアウトの「<strong>gravity</strong>」属性を用いることで、レイアウト内の View 要素を左詰め（left）・中央揃え（center_horizontal）・右詰め（right）・幅を埋める（fill）・上詰め（top）・下詰め（bottom）等々、様々な並び方の自動調整が可能になる。<br>
例えば、二つのボタンを画面の中央に横並びにしたい場合、horizontalなLinearLayoutの中に２つのボタンを配置し、gravityをcenterにすれば良い。 </p>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig12.png" class="figure-img img-fluid rounded" alt="fig12.png">
                <figcaption class="figure-caption text-center">図１４　LinearLayoutの一例：vertical（左）とhorizontal（右）</figcaption>
              </figure>
              <h4>TableLayoutとGridLayout</h4>
              <p>
                TableLayoutはパーツを格子状に配置したい場合に使用する。HTMLの&lt;table&gt;タグと同じようにレイアウトを作成することができる。<br />
                GridLayout はTableLayoutと同じくパーツを格子状に配置したい場合に使用する。TableLayoutとの違いはTableLayoutは縦方向のセルの結合はできないが、GridLayoutでは可能である。
              </p>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig13.png" class="figure-img img-fluid rounded" alt="fig13.png">
                  <figcaption class="figure-caption text-center">図１５　TableLayout（左）とGridLayout（右）の一例</figcaption>
              </figure>
              <h4>FrameLayout</h4>
              <p>
                基本的には1つのパーツを配置するためのレイアウトである。複数のパーツを配置した場合、後から配置したパーツが前面に重なった状態で配置される。<br />
                FrameLayoutを応用として右図のようにボタンを押すことで表示される内容が変わる画面。
              </p>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig14.png" class="figure-img img-fluid rounded" alt="fig14.png">
                  <figcaption class="figure-caption text-center">図１６　FrameLayoutの一例とその応用例</figcaption>
              </figure>
              
              <div class="practice">
                <h3>演習問題2_2:</h3>
                図１７と同じ見た目（メニューバーの色は問わない）の新しいGUIを作成する（ａ～ｇは参考方法。他の方法有り）。
                <ol type="a">
                  <li>新しい Layout ファイルを作成し、その名前を <strong>layout_image</strong> とする。新しいLayoutファイルを作成する方法は２つ：「File➡New➡Layout Ressource File」、もしくはもともとあった activity_main.xml をコピー・ペーストする。また、<strong>layout_image</strong> に、全画面（match_parent）を埋める vertical <strong>LinearLayout</strong> を追加する（L1とする）。そのレイアウトをウィンドウに対して中央揃えに設定する。</li>
                  
                  <li><strong>MainActivity.java</strong> の onCreate メソッド内、どの Layout ファイルを表示させるかをしているする下記の１行がある。新しく作成したLayoutファイルが表示される用に、修正する。</li>
                  
                    <pre><code>setContentView(R.layout.activity_main);</code></pre>
                  
                  <li>CANVASから<strong>mipmap-mdpi.zip</strong>ファイルを Download し、パソコンの File Explorer を使って zip アーカイブを展開する。画像ファイルをコピーし（右クリック→）「Copy」、Android Studioのリソース内 <strong>res</strong> の <strong>mipmap</strong> フォルダにペースト（右クリック→「Paste」）する（drag &amp; dropも可）。ペーストの際現れるポップアップにおいて <strong>mipmap-mdpi</strong> サブフォルダを選択する（他のを選ぶと、画像が非常に小さくなってしまうので、注意）</li>
                  
                  <li>L1 レイアウトの中に追加する新しい <strong>LinearLayout</strong> （L2とする）と中に追加する新しい TextView を作成する。L2レイアウトの背景属性に "<strong>player_background.png</strong>" を設定する。TextViewの文字が背景画像の絵の内側に表示されるように、L2 レイアウトの padding 属性を調整する。
                  </li>
                                    
                  <li>さらに、新しい LinearLayout （L3とする）を作成し、L1 の中に追加する。L3 に追加していく View 要素が<strong>横並び中央揃え</strong>になるように、L3 の属性を適切に設定する。</li>
                  
                  <li>２つのボタンを作成し、L3 レイアウトに追加したのち、他の属性を下記の通りに変更する。
                    <ol>
                      <li>各ボタンのテキストを削除する。</li>
                      <li>各ボタンの幅と高さが <strong>"内容にフィットする"</strong> ように該当属性を設定する。</li>
                      <li>ボタンの ID を<strong>play_btn</strong>と<strong>stop_btn</strong>に変更
                      </li>                      
                      <li>２つのボタンの背景属性（background）をそれぞれ <strong>play_icon_default.png</strong> （play_btn）と <strong>stop_icon_default.png</strong> （stop_btn）に設定する（先ほど mipmap リソースにコピーした画像に含まれている）にする。</li>
                    </ol></li>
                  
                  <table width=280 border="1"><caption >Table 1. 各 LinearLayout の入れ子関係</caption>
                    <tr align="center"><td>L1</td></tr><tr><td><table width=280 border="1"><tr><td>L2 (text &amp; bg)</td></tr></table></td></tr><tr><td><table width=280 border="1"><tr align="center"><td>L3 (2 btn)</td></tr></table></td></tr>
                  </table>                                
                  
                  <!--<li>各viewの背景の色（background属性）を統一する</li>-->
                  
                  <li><strong>play_btn</strong> をタップするとき、TextView に "Let’s Play!"、 <strong>stop_btn</strong> をタップするとき、TextView に "Stop playing" が表示されるように、各ボタンの onClick 属性を設定し、必要な method と処理を MainActivity.java に追加する（演習課題2_1-iを参照）。</li>
                </ol>
              </div>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig17.png" class="figure-img img-fluid rounded" alt="fig17.png" border="4px">
                  <figcaption class="figure-caption text-center">図１７　演習問題2_2：「ｇ」まで実装した際の実行画面スクリーンショット</figcaption>
              </figure><br /><br />
            </div>
            <div class="contents">
              <h2>ActionBarによるUI実装</h2>
              <p>
                <strong>Actionbar</strong>とは、Android 2.x以前のタイトルバーを置き換えつつ、ロゴ、ボタン、タブなどを配置できるツールバーである。具体例としてActionBarは下図の赤枠で囲まれたものである。<br />
                縦向きと横向きで表示のされ方が異なることに注意が必要。
              </p>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig18.png" class="figure-img img-fluid rounded" alt="fig18.png">
                  <figcaption class="figure-caption text-center">図２０　ActionBarの一例。Landscape表示（上）Portrait表示（下）</figcaption>
              </figure>
              <p>ActionBarActivityを新たに作成する。ただし、<strong><u>自分の名前の頭文字</u>・<u>自分の学生番号</u></strong>を使用すること。</p>
              <pre>
                <code class="java">
	Activity: Empty Activity
	Name: <strong>LG</strong> Action Bar Activity
	Package name: jp.aoyama.<strong>a00001</strong>.lgactionbaractivity
	Layout name: layout_action_bar.xml　（後で名前変更）
	Menu name: menu_action_bar.xml　（後で新規作成）
	Save location: 任意
	Language: Java
	Minimum SDK: 使用端末のAndroidバージョン以下を選択
                </code>
              </pre>
              <h4>アクションバーを表示する</h4>
              <strong>Action Bar</strong>を表示させるため、下記のメソッドを追加する必要があります。
              <pre>
                <code class="java">
      @Override
      public boolean onCreateOptionsMenu(Menu menu){
      //Inflate the menu; this adds items to the action bar if it is present.
      getMenuInflater().inflate(R.menu.menu_action_bar, menu);
      return true;
      }
                </code>
              </pre>
              <p>
                OnCreateOptionsMenu – 親クラスのOnCreateで自動的に呼び出されるメソッドです。MenuInflaterのinstanceを用いてres/menu に作成したmenu_action_bar.xmlの中身をAction barにメニューをinflateさせない（“膨らませる”）とメニューが表示されない。
              </p>
              <h4>アクションアイテムを表示する</h4>
              <p>
                <strong>ActionBar</strong>に表示する<strong>MenuItem</strong>が2つまでなら、上部のActionBarに表示されるため分割されない。3つ目から縦画面では表示されなくなる。<br />
                分割した場合、5つまでなら表示され、6つ目から表示されなくなる。MenuItemを2つに抑える、または3つ目以降の使用頻度が低いなどの場合は分割しない、横画面専用にする、などの方針をアプリ設計時に行うようにする必要がある。<br />
                <strong>ActionBar</strong>は従来のメニューを置き換えるものであることから、<strong>アイコン</strong>は、従来のメニューの<u>MenuItem</u>と同じものを使用する。以下は本サンプルの「menu_action_bar.xml」の内容。
                重要なのは、item要素の「<strong>android:showAsAction</strong>」という属性。この属性を用いてActionBar上でメニューアイテムがどのように配置、表示されるかを指定できる。
              </p>
              <table class="table">
                <tr>
                  <th>値</th>
                  <th>意味</th>
                </tr>
                <tr>
                  <td>never</td>
                  <td>常に表示しない</td>
                </tr>
                <tr>
                  <td>ifRoom</td>
                  <td>表示する余裕があれば表示</td>
                </tr>
                <tr>
                  <td>always</td>
                  <td>常に表示</td>
                </tr>
                <tr>
                  <td>withText</td>
                  <td>android:titleのテキストを表示。"|"を使用して他の値と同時に指定可能</td>
                </tr>
                <tr>
                  <td>collapseActionView</td>
                  <td>android:actionViewLayoutで指定されているアクションビューと関連付ける。"|"を使用して他の値と同時に指定可能</td>
                </tr>
              </table>
              <h5>menu_action_bar.xml</h5>
              <pre>
                <code class="xml">
        &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
        &lt;menu xmlns:android="http://schemas.android.com/apk/res/android"
            xmlns:app="http://schemas.android.com/apk/res-auto"
            xmlns:tools="http://schemas.android.com/tools"
            tools:context="jp.aoyama.a00001.actionbaractivity">
            &lt;item android:id="@+id/action_settings" android:title="@string/action_settings"
                android:icon="@android:drawable/ic_menu_preferences"
                app:showAsAction="ifRoom|withText" />
            &lt;item android:id="@+id/action_edit" android:title="@string/action_edit"
                android:icon="@android:drawable/ic_menu_edit"
                app:showAsAction="ifRoom|withText" />
            &lt;item android:id="@+id/action_preview" android:title="@string/action_preview"
                android:icon="@android:drawable/ic_menu_view"
                app:showAsAction="ifRoom|withText" />
            &lt;item android:id="@+id/action_save" android:title="@string/action_save"
                android:icon="@android:drawable/ic_menu_save"
                app:showAsAction="ifRoom|withText" />
        &lt;/menu&gt;
                </code>
              </pre>
              <p>
                多くのケースで有効なのが「<strong>ifRoom|withText</strong>」。表示されるアイコンを見て、機能が確実に推測できるのであれば<strong>withText</strong>を省略するのも方法の1つである。<br />
                <strong>always</strong>は表示するスペースがなくても強制的に表示するため、使用する際に注意が必要。
              </p>
              <div class="practice">
                <h3>演習問題2_3:図 19のように、ActionBarの調整する（aは参考方法。他の方法有り）</h3>
                <ol type="a">
                  <li>縦表示でも、常に”save”が表示されるように、または常に全てのメニューが隠れるようにmenu_action_bar.xmlを変更する</li>
                </ol>
              </div>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig19.png" class="figure-img img-fluid rounded" alt="fig19.png">
                  <figcaption class="figure-caption text-center">図２１　“save”アイテムが常に表示されている（左）と全アイテムが非表示になっている（右）Action Barを設定したときのアプリ実行時スクリーンショット</figcaption>
              </figure>
              <h4>アプリケーションアイコンに機能を追加する</h4>
              <p>
                Android 2.3以前のアプリ内でのナビゲーションはシステムの戻るボタン（Back ボタン）を使って行われていた。Android 3.0よりアクションバー（Action Bar）が導入され、<br />
                第2のナビゲーションメカニズムとして <strong>ホームボタン</strong>（正式に<strong>Upボタン</strong>）が登場した。このボタンはアプリアイコンと左向きのキャラットで構成されている。<br />
                Action Barにはアプリケーションのブランディングの意味も含め、アプリケーションアイコンが表示されている。<br />
                このアイコンにナビゲーション機能を持たせるためUpボタン機能を追加する方法としてActionBarオブジェクトの下記メソッドを用いる。
              </p>
              <ul>
                <li>setDisplayShowHomeEnabled(boolean)：<strong>アプリアイコン</strong>の表示・非表示させる</li>
                <li>setIcon(R.mipmap.ic_launcher)：<strong>アプリアイコン</strong>を表示する。上述のsetDisplayShowHomeEnabledと一緒に使用する</li>
                <li>setDisplayHomeAsUpEnabled(boolean)：アプリアイコンの横に<strong>Upボタン</strong>を追加する</li>
                <li>setHomeButtonEnabled(boolean)：<strong>タップイベント</strong>を可能・不可能にする</li>
              </ul>
              <p>
                ActionBarオブジェクトのインスタンスは<strong>getSupportActionBar()</strong>メソッドで取得可能。<br />
                アプリアイコンがタップされた場合、Activityの<strong>onOptionsItemSelected(…)</strong>メソッドに通知され、これを ハンドリングして、アプリのホーム画面に遷移するように実装できる。<br />
                【注意】：setHomeAsUpEnabled(true)が呼び出されたら、setHomeButtonEnabled(boolean)もtrueで設定される。これはsetHomeAsUpEnabled(false)で解除しても、<br />
                引き続きsetHomeButtonEnabled(boolean)は有効なままなので、アプリアイコンがタップできてしまい、つまりイベントが通知されてしまう。<br />
                setHomeAsUpEnabled(false)を行った際にsetHomeButtonEnabled(false)も忘れずに...
              </p>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig20.png" class="figure-img img-fluid rounded" alt="fig20.png">
                  <figcaption class="figure-caption text-center">図２２　「アプリアイコン」や「戻るアイコン」が表示されていない（左）と表示されている（右）場合のスクリーンショット</figcaption>
              </figure>
              <p>Back と Up を使用したナビゲーションについてガイドラインがありますので、詳細は<a class="external-link" href="https://developer.android.com/guide/navigation/navigation-design-graph?hl=ja">Android Developer Site</a>を参照して下さい。<br />
                さらに<a class="external-link" href="https://developer.android.com/design?hl=ja">Android Design Principles</a>（style、color、navigation等）というものも存在しているので、Google Playで配布予定のApplicationを開発する際、そこを良く勉強しておくことをお薦めします。
              </p>
              <div class="practice">
                <h3>演習問題2_3: ActionBarのイベントハンドリング（bは参考方法。他の方法有り）</h3>
                <ol type="a">
                  <li value="2">戻るボタン、setting、edit、preview、saveの各ボタンをタップする際、"Hello world!”を表示しているTextView内、改行して押したボタンが分かるようなテキストが追加表示されるようにActionBarActivity.javaに必要なメソッド呼び出しや処理を追加する（図 21を参照）。<br />
                    【hint 1】TextViewオブジェクトにテキストを設定するのはsetText(…)メソッドですが、テキストを追加するには<strong>append(…)</strong>メソッドを用いる。<br>
【hint 2】「戻る」ボタンのIDは自分で設定したIDではなくAndroidで事前に設定されている：<strong>android.R.id.home</strong>。</li>
                </ol>
              </div>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig21.png" class="figure-img img-fluid rounded" alt="fig21.png" border="4px">
                  <figcaption class="figure-caption text-center">図２３　演習問題2_3：bの実行結果スクリーンショット</figcaption>
              </figure>
            </div>

            <div class="contents">
              <h2>Androidアプリで“アニメーション”するための基礎知識</h2>
              <h4>ANDROIDはアニメーションを最初から重要視</h4>
              <p>
                「アニメーション」機能は、Androidが提供するそのほかの機能に比べると、実用度は低いように感じられますが、実はバージョン1.0よりも以前からアニメーションはAPIとして開発者に提供されています。<br />
                その後、追加された機能に優先してアニメーションが初めから用意されているのはなぜでしょうか。Androidはシステム全体を通してアニメーションが駆使できるように設計されています。<br />
                「メニューを開く」「アクティビティを起動する」「ダイアログを表示する」というような基本的な動作にもアニメーションが使用されています。<br />
                アクティビティの切り替え時や、ダイアログ表示時のアニメーションは次回解説します。今回は、GUIコンポネントに対するアニメーションを見ていきましょう。
              </p>
              <h4>ANDROIDのアニメーションの4つの基本動作と合成</h4>
              <p>
                Androidのアニメーションは、「<b>android.view.animation</b>」パッケージで実現する。このパッケージには、Animationクラスと、その<b>サブクラス</b>が用意されている。
              </p>
              <table class="table">
                <tr>
                  <th>クラス名</th>
                  <th>概要</th>
                </tr>
                <tr>
                  <td>Animation</td>
                  <td>すべてのアニメーションの基底の<b>抽象クラス</b></td>
                </tr>
                <tr>
                  <td>AlphaAnimation</td>
                  <td>フェードイン/アウト</td>
                </tr>
                <tr>
                  <td>RotateAnimation</td>
                  <td>回転</td>
                </tr>
                <tr>
                  <td>ScaleAnimation</td>
                  <td>拡大・縮小</td>
                </tr>
                <tr>
                  <td>TranslateAnimation</td>
                  <td>移動</td>
                </tr>
                <tr>
                  <td>AnimationSet</td>
                  <td>複数のアニメーションを合成</td>
                </tr>
              </table>
              <h4>フェードイン/アウト</h4>
              <p>
                下記の属性を持った新しいProjectを作成する。ただし、<strong><u>自分の名前の頭文字</u>・<u>自分の学生番号</u></strong>を使用すること。
              </p>
              <pre>
                <code class="java">
      Activity: Empty Activity
      Name: <strong>LG</strong> Animation
      Package name: jp.aoyama.<strong>a00001</strong>.lganimation
      Save location: 任意
      Language: Java
      Minimum SDK: 使用端末のAndroidバージョン以下を選択
                </code>
              </pre>
              <p>
                アニメーション開始時とアニメーション終了時の透明度を設定して、フェイドイン／フェイドアウトを表現する。<br />
                「<strong>AlphaAnimationExample</strong>」例のソースコードの一部と画面のスクリーンショットを次に示している。
              </p>
              <h5>AlphaAnimationExample.java</h5>
              <pre>
                <code class="java">
      package jp.aoyama.a00001.animation;

      //importを省略
      import android.view.animation.AlphaAnimation;

      public class AlphaAnimationExample extends Activity {
        @Override
        public void onCreate(Bundle savedInstanceState) {
          super.onCreate(savedInstanceState);
          setContentView(R.layout.hoge);
        }

        public void onClick(View v) {
          float fromAlpha = Float.parseFloat(((EditText)hoge).getText().toString());
          float toAlpha = Float.parseFloat(((EditText)hoge).getText().toString());
          AlphaAnimation animation = new AlphaAnimation(fromAlpha, toAlpha);
          //アニメーション時間の設定
          animation.setDuration(5000);
          //Viewがアニメーションを開始
          v.startAnimation(animation);
        }
      }
                </code>
              </pre>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig22.png" class="figure-img img-fluid rounded" alt="fig22.png">
                  <figcaption class="figure-caption text-center">図２４　アニメーションの動作確認画面</figcaption>
              </figure>
              <p>
                AlphaAnimationは開始透明度と終了透明度を指定可能で、図 22は不透明から、80％透明にアニメーションする。
              </p>
              <table class="table">
                <tr>
                  <th>コンストラクタ引数</th>
                  <th>説明</th>
                </tr>
                <tr>
                  <td>float fromAlpha</td>
                  <td>アニメーション開始時の透明度を0.0～1.0の間で指定。0.0は完全透明、1.0は完全不透明</td>
                </tr>
                <tr>
                  <td>float toAlpha</td>
                  <td>アニメーション終了時の透明度を0.0～1.0の間で指定。0.0は完全透明、1.0は完全不透明</td>
                </tr>
              </table>
              <div class="practice">
                <h3>演習問題2_4: 透明化アニメーション（a~dは参考方法。他の方法有り）</h3>
                <ol type="a">
                  <li>AlphaAnimationExampleを完成させ（"hoge"を埋めたものとXMLレイアウト）実機実行にて動作を確認する。</li>
                </ol>
              </div>
              <div class="practice">
                <h3>演習問題2_4: 複数のAnimation種類を自由に組み合わせたテストアプリの作成）</h3>
                <ol type="a">
                  <li value="2">同プロジェクト内に新たなActivity Classとして<strong>MultipleAnimationExample.java</strong>ファイルを作成</li>
                  <li><strong>MultipleAnimationExample</strong> Class用のレイアウト<strong>layout_multiple_animation.xml</strong>を作成</li>
                  <li>複数のAnimationを組み合わせるための下記サンプルコード（MultipleAnimationSample.java）を参考にして、図２３のように、<strong>CheckBox</strong>と<strong>EditText</strong>を用いて、<strong>自由にAnimationを組み合わせる</strong>ことができるようにするGUIを作成</li>
                </ol>
              </div>
              <h5>MultipleAnimationSample.java</h5>
              <pre>
                <code class="java">
        public void onClick(View v) {
          // 【1】インスタンスを生成
          AnimationSet set = new AnimationSet(true);

          // 【2】基本のアニメーションを生成
          AlphaAnimation alpha = new AlphaAnimation(0.9f, 0.2f);
          RotateAnimation rotate = new RotateAnimation(0, 360, 50, 25);
          ScaleAnimation scale = new ScaleAnimation(0.1f, 1, 0.1f, 1);
          TranslateAnimation translate = new TranslateAnimation(50, 0, 200, 0);

          // 【3】生成したアニメーションを追加
          set.addAnimation(alpha);
          set.addAnimation(rotate);
          set.addAnimation(scale);
          set.addAnimation(translate);

          // 【4】アニメーション時間を設定して動作開始
          set.setDuration(3000);
          v.startAnimation(set);
        }
                </code>
              </pre>
              <p>
                上記サンプルコードは<a class="external-link" href="https://www.atmarkit.co.jp/ait/articles/1009/15/news120_2.html">https://www.atmarkit.co.jp/ait/articles/1009/15/news120_2.html</a>からの引用。<br />
                チェックボックスの使い方については<a class="external-link" href="https://developer.android.com/guide/topics/ui/controls/checkbox.html?hl=ja">Android Developerサイト</a>を参考に。
              </p>
              <figure class="figure">
                  <img src="assets/images/ex2nd/fig23.png" class="figure-img img-fluid rounded" alt="fig23.png">
                  <figcaption class="figure-caption text-center">図２５　演習問題2_2の実行例</figcaption>
              </figure>
            </div>
            <h3>参考文献</h3>
            <ul>
              <li>ANDROID STUDIOで始めるANDROIDアプリ開発の教科書</li>
              <li>
                <a class="external-link" href="https://developer.android.com/index.html?hl=ja">https://developer.android.com/index.html?hl=ja</a>
              </li>
              <li>
                <a class="external-link" href="http://www.atmarkit.co.jp/ait/articles/1009/15/news120.html">http://www.atmarkit.co.jp/ait/articles/1009/15/news120.html</a>
              </li>
              <li>
                <a class="external-link" href="https://www.raywenderlich.com/2176-android-tutorial-for-beginners-part-2">https://www.raywenderlich.com/2176-android-tutorial-for-beginners-part-2</a>
              </li>
            </ul>
            </div>
    </body>
</html>
